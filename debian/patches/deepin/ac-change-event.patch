commit 44f83866b5f41b01bee47143a4d52573ff9f43ed
Author: Yang Bo <yangbo@deepin.com>
Date:   Wed Mar 14 08:12:27 2018 +0800

    Notify ac status
    
    Signed-off-by: Yang Bo <yangbo@deepin.com>

diff --git a/drivers/acpi/ac.c b/drivers/acpi/ac.c
index f71b756b0..a8363a2bc 100644
--- a/drivers/acpi/ac.c
+++ b/drivers/acpi/ac.c
@@ -283,7 +283,9 @@ static int acpi_ac_battery_notify(struct notifier_block *nb,
 {
 	struct acpi_ac *ac = container_of(nb, struct acpi_ac, battery_nb);
 	struct acpi_bus_event *event = (struct acpi_bus_event *)data;
+	struct acpi_device *device;
 
+	device = ac->device;
 	/*
 	 * On HP Pavilion dv6-6179er AC status notifications aren't triggered
 	 * when adapter is plugged/unplugged. However, battery status
@@ -292,8 +294,14 @@ static int acpi_ac_battery_notify(struct notifier_block *nb,
 	 * if AC status has changed.
 	 */
 	if (strcmp(event->device_class, ACPI_BATTERY_CLASS) == 0 &&
-	    event->type == ACPI_BATTERY_NOTIFY_STATUS)
+	    (event->type == ACPI_BATTERY_NOTIFY_STATUS ||
+	     event->type == ACPI_BATTERY_NOTIFY_INFO)) {
 		acpi_ac_get_state(ac);
+		acpi_bus_generate_netlink_event(device->pnp.device_class,
+						  dev_name(&device->dev), ACPI_AC_NOTIFY_STATUS,
+						  (u32) ac->state);
+		kobject_uevent(&ac->charger->dev.kobj, KOBJ_CHANGE);
+	}
 
 	return NOTIFY_OK;
 }
