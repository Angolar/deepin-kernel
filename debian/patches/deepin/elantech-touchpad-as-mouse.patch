commit d379d7866dd6ed0cab81b482a80ae3bac518e718
Author: Yang Bo <yangbo@deepin.com>
Date:   Thu Feb 9 12:28:38 2017 +0800

    elantech: touchpad is used as PS/2 mouse
    
    Signed-off-by: Yang Bo <yangbo@deepin.com>

diff --git a/drivers/input/mouse/elantech.c b/drivers/input/mouse/elantech.c
index db7d1d666..e1a336e96 100644
--- a/drivers/input/mouse/elantech.c
+++ b/drivers/input/mouse/elantech.c
@@ -1565,6 +1565,25 @@ static const struct dmi_system_id no_hw_res_dmi_table[] = {
 	{ }
 };
 
+static int elantech_buggy_firmware(const struct dmi_system_id *d)
+{
+	return 1;
+}
+
+static const struct dmi_system_id elantech_buggy_fw[] = {
+	{
+#if defined(CONFIG_DMI) && defined(CONFIG_X86)
+		.callback = elantech_buggy_firmware,
+		.ident = "LENOVO 80UN",
+		.matches = {
+			DMI_MATCH(DMI_SYS_VENDOR, "LENOVO"),
+			DMI_MATCH(DMI_PRODUCT_NAME, "80UN"),
+		},
+	},
+#endif
+	{ }
+};
+
 /*
  * determine hardware version and set some properties according to it.
  */
@@ -1593,6 +1612,11 @@ static int elantech_set_properties(struct elantech_data *etd)
 		}
 	}
 
+	if (dmi_check_system(elantech_buggy_fw)) {
+		etd->hw_version = 1;
+		etd->debug = 1;
+	}
+
 	/* decide which send_cmd we're gonna use early */
 	etd->send_cmd = etd->hw_version >= 3 ? elantech_send_cmd :
 					       synaptics_send_cmd;
@@ -1677,7 +1701,7 @@ int elantech_init(struct psmouse *psmouse)
 		     etd->capabilities[0], etd->capabilities[1],
 		     etd->capabilities[2]);
 
-	if (etd->hw_version != 1) {
+	if (etd->hw_version != 1 || dmi_check_system(elantech_buggy_fw)) {
 		if (etd->send_cmd(psmouse, ETP_SAMPLE_QUERY, etd->samples)) {
 			psmouse_err(psmouse, "failed to query sample data\n");
 			goto init_fail;
